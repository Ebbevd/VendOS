{% extends "main/base.html" %}
{% load static %}

{% block content %}
<a href="{% url 'order_screen' %}" class="splash-container">
    <img src="{% static 'VendOS/media/mystery.png' %}" 
         alt="Package" 
         class="dvd-logo" 
         id="dvdLogo">
    <div class="splash-text">Touch the screen to order</div>
</a>

<style>
html, body {
    margin: 0;
    padding: 0;
    height: 100%;
}

.dvd-logo {
    position: absolute;
    width: 100px;   /* fixed size for caching */
    height: auto;
    will-change: transform; /* hint for smoother GPU rendering */
}

/* Text overlay */
.splash-text {
    position: absolute;
    width: 100%;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    text-align: center;
    font-size: 2rem;
    font-weight: bold;
    color: #000;
    pointer-events: none;
}
</style>

<script>
const logo = document.getElementById('dvdLogo');
const container = document.querySelector('.splash-container');

let logoWidth = logo.offsetWidth;
let logoHeight = logo.offsetHeight;
let containerWidth = container.clientWidth;
let containerHeight = container.clientHeight;

// Start position
let posX = Math.random() * (containerWidth - logoWidth);
let posY = Math.random() * (containerHeight - logoHeight);

// Fixed speed
let velX = 2;
let velY = 2;

// Track current hue
let currentHue = 0;

// Update container size when window resizes
function updateContainerSize() {
    containerWidth = container.clientWidth;
    containerHeight = container.clientHeight;

    // Ensure logo stays inside bounds after resize
    if (posX + logoWidth > containerWidth) posX = containerWidth - logoWidth;
    if (posY + logoHeight > containerHeight) posY = containerHeight - logoHeight;
}
window.addEventListener('resize', updateContainerSize);

function animate() {
    posX += velX;
    posY += velY;

    let bounced = false;

    if (posX + logoWidth >= containerWidth || posX <= 0) {
        velX = -velX;
        bounced = true;
    }
    if (posY + logoHeight >= containerHeight || posY <= 0) {
        velY = -velY;
        bounced = true;
    }

    if (bounced) changeColor();

    // GPU-friendly transform
    logo.style.transform = `translate(${posX}px, ${posY}px)`;

    requestAnimationFrame(animate);
}

function changeColor() {
    let newHue;
    do {
        newHue = Math.floor(Math.random() * 360);
    } while (Math.abs(newHue - currentHue) < 40);
    currentHue = newHue;
    logo.style.filter = `hue-rotate(${currentHue}deg)`;
}

animate();
</script>
{% endblock %}
