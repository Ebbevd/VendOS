{% extends "main/base.html" %}
{% load static %}

{% block content %}
<div class="success-screen">
    <div class="success-card">
        <h1 class="success-title">Success!</h1>
        <p class="success-message">Your payment has been received.</p>
        <div class="dispense-section">
            <img src="{% static 'VendOS/media/gear.gif' %}" alt="Dispensing product..." class="gear-animation">
            <p class="dispense-text">Dispensing your product...</p>
        </div>
    </div>
</div>

<script>
    const productId = {{ product.id }};
    const dispenseTime = {{ dispense_time }};
    const returnUrl = "{% url 'splash_screen' %}";

    fetch(`/payments/dispense/${productId}/${dispenseTime}/`)
        .then(res => res.json())
        .then(data => console.log(data))
        .catch(err => console.error(err));

    setTimeout(() => {
        window.location.href = returnUrl;
    }, dispenseTime * 1000);
</script>

{% endblock content %}
